<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clash Royale Battle Log</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-gray-100 font-sans min-h-screen">
    <div class="container mx-auto p-4 sm:p-6">
        <div class="bg-gray-800 rounded-xl shadow-lg p-6 relative">
            <!-- Back to Dashboard Button -->
            <a
                href="/"
                class="absolute top-4 left-4 bg-blue-500 text-white font-semibold px-4 py-2 rounded-lg hover:bg-blue-600 transition duration-300 ease-in-out"
            >
                Back to Dashboard
            </a>
            <h1 class="text-3xl sm:text-4xl font-extrabold text-blue-400 mb-6 text-center">Clash Royale Battle Log</h1>

            {% for battle in battles %}
            <div class="border-b border-gray-600 pb-6 mb-6">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-blue-400 mb-4">Battle Details</h2>
                    <p><strong>Type:</strong> {{ battle.type }}</p>
                    <p><strong>Battle Time:</strong> {{ battle.battleTime | replace('T', ' ') | replace('.000Z', '') }}</p>
                    <p><strong>Arena:</strong> {{ battle.arena.name }} (ID: {{ battle.arena.id }})</p>
                    <p><strong>Game Mode:</strong> {{ battle.gameMode.name }} (ID: {{ battle.gameMode.id }})</p>
                    <p><strong>Deck Selection:</strong> {{ battle.deckSelection }}</p>
                    <p><strong>League Number:</strong> {{ battle.leagueNumber | default('N/A') }}</p>
                    <p><strong>Is Ladder Tournament:</strong> {{ battle.isLadderTournament }}</p>
                    <p><strong>Is Hosted Match:</strong> {{ battle.isHostedMatch }}</p>
                </div>

                {% for team in battle.team %}
                <div class="mb-6 p-4 border-l-4 border-blue-500 bg-gray-700 rounded-lg">
                    <h2 class="text-xl font-bold text-blue-400">Player: {{ team.name }}</h2>
                    <p><strong>Tag:</strong> {{ team.tag }}</p>
                    <p><strong>Starting Trophies:</strong> {{ team.startingTrophies }}</p>
                    <p><strong>Trophy Change:</strong> {{ team.trophyChange }}</p>
                    <p><strong>Crowns:</strong> {{ team.crowns }}</p>
                    <p><strong>King Tower Hit Points:</strong> {{ team.kingTowerHitPoints }}</p>
                    {% if team.princessTowersHitPoints %}
                        <p><strong>Princess Towers Hit Points:</strong> {{ team.princessTowersHitPoints | default('Not available') }}</p>
                    {% else %}
                        <p>Princess Tower Destroyed.</p>
                    {% endif %}
                    <p><strong>Clan:</strong> {{ team.clan.name if team.clan else 'No clan' }} (Tag: {{ team.clan.tag if team.clan else 'N/A' }}, Badge ID: {{ team.clan.badgeId if team.clan else 'N/A' }})</p>
                    <p><strong>Elixir Leaked:</strong> {{ team.elixirLeaked | round(2) }}</p>

                    <h3 class="text-lg font-semibold text-blue-400 mt-4">Cards</h3>
                    <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 mt-2">
                        {% for card in team.cards %}
                        <div class="bg-gray-600 p-3 rounded-md text-center">
                            <img src="{{ card.iconUrls.medium }}" alt="{{ card.name }}" class="w-20 mx-auto mb-2">
                            <p><strong>{{ card.name }}</strong><br>({{ card.rarity | capitalize }}, Level {{ card.level }}{% if card.starLevel %}, Star Level {{ card.starLevel }}{% endif %}{% if card.evolutionLevel %}, Evolution Level {{ card.evolutionLevel }}{% endif %}, Elixir: {{ card.elixirCost }})</p>
                        </div>
                        {% endfor %}
                    </div>

                    <h3 class="text-lg font-semibold text-blue-400 mt-4">Support Cards</h3>
                    <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 mt-2">
                        {% for card in team.supportCards %}
                        <div class="bg-gray-600 p-3 rounded-md text-center">
                            <img src="{{ card.iconUrls.medium }}" alt="{{ card.name }}" class="w-20 mx-auto mb-2">
                            <p><strong>{{ card.name }}</strong><br>({{ card.rarity | capitalize }}, Level {{ card.level }})</p>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endfor %}

                {% for opponent in battle.opponent %}
                <div class="mb-6 p-4 border-l-4 border-red-500 bg-gray-700 rounded-lg">
                    <h2 class="text-xl font-bold text-red-400">Opponent: {{ opponent.name }}</h2>
                    <p><strong>Tag:</strong> {{ opponent.tag }}</p>
                    <p><strong>Starting Trophies:</strong> {{ opponent.startingTrophies }}</p>
                    <p><strong>Trophy Change:</strong> {{ opponent.trophyChange }}</p>
                    <p><strong>Crowns:</strong> {{ opponent.crowns }}</p>
                    <p><strong>King Tower Hit Points:</strong> {{ opponent.kingTowerHitPoints }}</p>
                    <p><strong>Princess Towers Hit Points:</strong> {{ opponent.princessTowersHitPoints | default('Not available') }}</p>
                    <p><strong>Clan:</strong> {{ opponent.clan.name if opponent.clan else 'No clan' }} (Tag: {{ opponent.clan.tag if opponent.clan else 'N/A' }}, Badge ID: {{ opponent.clan.badgeId if opponent.clan else 'N/A' }})</p>
                    <p><strong>Elixir Leaked:</strong> {{ opponent.elixirLeaked | round(2) }}</p>

                    <h3 class="text-lg font-semibold text-red-400 mt-4">Cards</h3>
                    <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 mt-2">
                        {% for card in opponent.cards %}
                        <div class="bg-gray-600 p-3 rounded-md text-center">
                            <img src="{{ card.iconUrls.medium }}" alt="{{ card.name }}" class="w-20 mx-auto mb-2">
                            <p><strong>{{ card.name }}</strong><br>({{ card.rarity | capitalize }}, Level {{ card.level }}{% if card.starLevel %}, Star Level {{ card.starLevel }}{% endif %}{% if card.evolutionLevel %}, Evolution Level {{ card.evolutionLevel }}{% endif %}, Elixir: {{ card.elixirCost }})</p>
                        </div>
                        {% endfor %}
                    </div>

                    <h3 class="text-lg font-semibold text-red-400 mt-4">Support Cards</h3>
                    <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 mt-2">
                        {% for card in opponent.supportCards %}
                        <div class="bg-gray-600 p-3 rounded-md text-center">
                            <img src="{{ card.iconUrls.medium }}" alt="{{ card.name }}" class="w-20 mx-auto mb-2">
                            <p><strong>{{ card.name }}</strong><br>({{ card.rarity | capitalize }}, Level {{ card.level }})</p>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endfor %}
        </div>
    </div>
</body>
</html>